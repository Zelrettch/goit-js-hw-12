{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-btn');\nconst gallery = document.querySelector('.gallery');\n\nexport function fillGalery(images, gallery) {\n  const cardset = images.map(e => {\n    return createCard(e);\n  });\n  gallery.append(...cardset);\n}\n\nfunction createCard(data) {\n  const img = document.createElement('img');\n  const stats = document.createElement('div');\n  const link = document.createElement('a');\n  const card = document.createElement('li');\n\n  card.classList.add('card');\n  stats.classList.add('stats');\n\n  link.href = data.largeImageURL;\n  const thumb = setupImg(img, data);\n\n  stats.append(...createFields(data));\n  link.append(thumb, stats);\n  card.append(link);\n\n  return card;\n}\n\nfunction setupImg(img, data) {\n  const thumb = document.createElement('div');\n\n  thumb.classList.add('thumb');\n  img.src = data.webformatURL;\n  img.alt = data.tags;\n\n  thumb.append(img);\n  return thumb;\n}\n\nfunction createFields(data) {\n  return ['likes', 'views', 'comments', 'downloads'].map(el => {\n    const field = document.createElement('div');\n    const label = document.createElement('span');\n    const value = document.createElement('span');\n\n    field.classList.add('field');\n    label.classList.add('label');\n    value.classList.add('value');\n\n    label.textContent = el;\n    value.textContent = data[el];\n\n    field.append(label, value);\n\n    return field;\n  });\n}\n\nexport function displayAlert(message, color = 'red') {\n  iziToast.show({\n    transitionIn: 'fadeInDown',\n    position: 'topRight',\n    color,\n    message,\n  });\n}\n\nexport function toggleLoader() {\n  loader.classList.toggle('is-hidden');\n}\n\nexport function showLoadBtn() {\n  loadBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadBtn() {\n  loadBtn.classList.add('is-hidden');\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n","'use strict';\n\nimport axios from 'axios';\n\nconst API_KEY = '47493519-a1c562378b8b6eff6e1575382';\naxios.defaults.headers.common['key'] = API_KEY;\n\nexport default async function fetchImages(filter, page) {\n  return await axios.get('https://pixabay.com/api', {\n    params: {\n      // key: API_KEY,\n      q: filter,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page,\n      per_page: 15,\n    },\n  });\n}\n","'use strict';\n\nimport {\n  fillGalery,\n  displayAlert,\n  clearGallery,\n  toggleLoader,\n  showLoadBtn,\n  hideLoadBtn,\n} from './js/render-functions';\nimport fetchImages from './js/pixabay-api';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst loadBtn = document.querySelector('.load-btn');\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery a');\nconst BAD_QUERY_MSG =\n  'Sorry, there are no images matching your search query. Please try again!';\nconst LAST_PAGE_MSG =\n  \"We're sorry, but you've reached the end of search results.\";\nconst IMAGES_PER_PAGE = 15;\n\nconst search = {\n  setQuery(query) {\n    this.query = query;\n    this.page = 1;\n    this.hasNext = true;\n  },\n\n  async fetchPage() {\n    const data = (await fetchImages(this.query, this.page)).data;\n\n    if (Math.ceil(data.total / IMAGES_PER_PAGE) <= this.page) {\n      this.hasNext = false;\n    }\n    this.page++;\n    return data;\n  },\n};\n\nfunction handleData(data) {\n  if (!data.hits.length) {\n    displayAlert(BAD_QUERY_MSG);\n  }\n  fillGalery(data.hits, gallery);\n  lightbox.refresh();\n}\n\nasync function loadPage() {\n  toggleLoader();\n  hideLoadBtn();\n  try {\n    const d = await search.fetchPage();\n    handleData(d);\n  } catch (e) {\n    displayAlert(e.message);\n    console.log(e.stack);\n  } finally {\n    toggleLoader();\n    if (search.hasNext) {\n      showLoadBtn();\n    }\n  }\n}\n\nfunction handleSearch(evt) {\n  evt.preventDefault();\n  const query = form.elements.input.value.trim();\n  if (query.length) {\n    search.setQuery(query);\n    clearGallery();\n    loadPage();\n  }\n}\n\nasync function handleLoadMore(evt) {\n  const lastCard = gallery.childElementCount;\n\n  await loadPage();\n  if (!search.hasNext) {\n    displayAlert(LAST_PAGE_MSG, 'blue');\n  }\n\n  const h = gallery.children[lastCard - 1].getBoundingClientRect().height;\n  scrollDown(h * 2);\n}\n\nfunction scrollDown(h) {\n  window.scrollTo({\n    top: h + window.scrollY,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nform.addEventListener('submit', handleSearch);\nloadBtn.addEventListener('click', handleLoadMore);\n"],"names":["loader","loadBtn","gallery","fillGalery","images","cardset","e","createCard","data","img","stats","link","card","thumb","setupImg","createFields","el","field","label","value","displayAlert","message","color","iziToast","toggleLoader","showLoadBtn","hideLoadBtn","clearGallery","API_KEY","axios","fetchImages","filter","page","form","lightbox","SimpleLightbox","BAD_QUERY_MSG","LAST_PAGE_MSG","IMAGES_PER_PAGE","search","query","handleData","loadPage","d","handleSearch","evt","handleLoadMore","lastCard","h","scrollDown"],"mappings":"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"}